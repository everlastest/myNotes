# ES7~ES12æ–°è¯­æ³•

## ES7 

### 1 Array.prototype.includesï¼ˆå¸¸ç”¨ï¼‰

ç”¨äºåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ 

**è¯­æ³•**

``arr.includes(valueToFind,index)``

ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦åŒ…æ‹¬çš„å€¼

ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¼€å§‹æœç´¢çš„ä½ç½®

**ä¾‹å­**

```js
[1, 2, 3].includes(2);     // true
[1, 2, 3].includes(4);     // false
[1, 2, 3].includes(3, 3);  // false
[1, 2, 3].includes(3, -1); // true
[1, 2, NaN].includes(NaN); // true
```

`includes()` æ–¹æ³•æœ‰æ„è®¾è®¡ä¸ºé€šç”¨æ–¹æ³•ã€‚å®ƒä¸è¦æ±‚ `this` å€¼æ˜¯æ•°ç»„å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«ç”¨äºå…¶ä»–ç±»å‹çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ç±»æ•°ç»„å¯¹è±¡ï¼‰ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†åœ¨å‡½æ•°çš„ `arguments` å¯¹è±¡ä¸Šè°ƒç”¨ `includes()` æ–¹æ³•ã€‚

### 2 Exponentiation Operator

æ±‚å¹‚è¿ç®—ç¬¦ï¼ˆ`**`ï¼‰è¿”å›å°†ç¬¬ä¸€ä¸ªæ“ä½œæ•°åŠ åˆ°ç¬¬äºŒä¸ªæ“ä½œæ•°çš„å¹‚çš„ç»“æœã€‚å®ƒç­‰æ•ˆäº `Math.pow`ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒä¹Ÿæ¥å— `BigInt` ä½œä¸ºæ“ä½œæ•°ã€‚ 

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 3 é˜¶æ®µã€‚

**è¯­æ³•**

 `var1 ** var2`

æ±‚å¹‚è¿ç®—ç¬¦æ˜¯æ˜¯å³ç»“åˆçš„: `a ** b ** c` ç­‰äº `a ** (b ** c)`ã€‚

**ä¾‹å­**

```js
2 ** 3   // 8
3 ** 2   // 9
3 ** 2.5 // 15.588457268119896
10 ** -1 // 0.1
NaN ** 2 // NaN

2 ** 3 ** 2   // 512
2 ** (3 ** 2) // 512
(2 ** 3) ** 2 // 64

-(2 ** 2) // -4
(-2) ** 2 // 4
```

## ES8

### 1 asyncå’Œawaitï¼ˆå¸¸ç”¨ï¼‰

å¼‚æ­¥çš„è¯­æ³•ç³–

**è¯­æ³•**

```js
const asyncReadFile = async function () {
  const f1 = await readFile('/etc/fstab');
  const f2 = await readFile('/etc/shells');
  console.log(f1.toString());
  console.log(f2.toString());
};
```

### 2 Object.valueså’ŒObject.entries

`Object.values()` æ–¹æ³•è¿”å›ä¸€ä¸ªç»™å®šå¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾å±æ€§å€¼çš„æ•°ç»„ï¼Œå€¼çš„é¡ºåºä¸ä½¿ç”¨ for...in å¾ªç¯çš„é¡ºåºç›¸åŒï¼ˆåŒºåˆ«åœ¨äº for...in å¾ªç¯æšä¸¾åŸå‹é“¾ä¸­çš„å±æ€§ï¼‰ã€‚

`Object.entries()` æ–¹æ³•è¿”å›ä¸€ä¸ªç»™å®šå¯¹è±¡è‡ªèº«å¯æšä¸¾å±æ€§çš„é”®å€¼å¯¹æ•°ç»„ï¼Œå…¶æ’åˆ—ä¸ä½¿ç”¨ for...in å¾ªç¯éå†è¯¥å¯¹è±¡æ—¶è¿”å›çš„é¡ºåºä¸€è‡´ï¼ˆåŒºåˆ«åœ¨äº for...in å¾ªç¯è¿˜ä¼šæšä¸¾åŸå‹é“¾ä¸­çš„å±æ€§ï¼‰ã€‚

> æ”¹ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**è¯­æ³•**

```js
Object.value(obj)
Object.entries(obj)
```

**ä¾‹å­**

```js
Object.values({a:Â 1,Â b:Â 2,Â c:Â 3});Â  //Â [1,Â 2,Â 3]
Object.keys({a:Â 1,Â b:Â 2,Â c:Â 3});Â    //Â [a,Â b,Â c]
Object.entries({a:Â 1,Â b:Â 2,Â c:Â 3});Â //Â [["a",Â 1],Â ["b",Â 2],Â ["c",Â 3]]
```

### 3 Object.getOwnPropertyDescriptors

è·å–ä¸€ä¸ªå¯¹è±¡æ‰€æœ‰è‡ªèº«å±æ€§çš„æè¿°ç¬¦ï¼Œå¦‚æœæ²¡æœ‰ä»»ä½•è‡ªèº«å±æ€§ï¼Œåˆ™è¿”å›ç©ºå¯¹è±¡ã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**è¯­æ³•**

``Object.getOwnPropertyDescriptors(obj)``

**ä¾‹å­**

```js
const a = { 
  b: 123,
  c: 'æ–‡å­—å†…å®¹',
  d() { return 2; }
};
Object.getOwnPropertyDescriptors(a);
// è¾“å‡ºç»“æœ
{
  b:{
    configurable: true,
    enumerable: true,
    value: 123,
    writable: true,
    [[Prototype]]: Object,
  }
  c:{
    configurable: true,
    enumerable: true,
    value: "æ–‡å­—å†…å®¹",
    writable: true,
    [[Prototype]]: Object,
  }
  d:{
    configurable: true,
    enumerable: true,
    value: Æ’ d(),
    writable: true,
    [[Prototype]]: Object,
  },
  [[Prototype]]: Object,
}
```

### 4 String.prototype.padStart å’Œ String.prototype.padEnd

`padStart()` æ–¹æ³•ç”¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²å¡«å……å½“å‰å­—ç¬¦ä¸²ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼Œä¼šé‡å¤å¤šæ¬¡ï¼‰ï¼Œä»¥ä¾¿äº§ç”Ÿçš„å­—ç¬¦ä¸²è¾¾åˆ°ç»™å®šçš„é•¿åº¦ã€‚ä»å½“å‰å­—ç¬¦ä¸²çš„å¼€å¤´ï¼ˆå·¦ä¾§ï¼‰å¼€å§‹å¡«å……ã€‚

`padEnd()` æ–¹æ³•ä¼šç”¨ä¸€ä¸ªå­—ç¬¦ä¸²å¡«å……å½“å‰å­—ç¬¦ä¸²ï¼ˆå¦‚æœéœ€è¦çš„è¯åˆ™é‡å¤å¡«å……ï¼‰ï¼Œè¿”å›å¡«å……åè¾¾åˆ°æŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²ã€‚ä»å½“å‰å­—ç¬¦ä¸²çš„æœ«å°¾ï¼ˆå³ä¾§ï¼‰å¼€å§‹å¡«å……ã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**è¯­æ³•**

``str.padStart(targetLength, padString)``

- `targetLength`ï¼šå½“å‰å­—ç¬¦ä¸²éœ€è¦å¡«å……åˆ°çš„ç›®æ ‡é•¿åº¦ã€‚å¦‚æœè¿™ä¸ªæ•°å€¼å°äºå½“å‰å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ™è¿”å›å½“å‰å­—ç¬¦ä¸²æœ¬èº«ã€‚
- `padString`ï¼šå¯é€‰çš„ã€‚å¡«å……å­—ç¬¦ä¸²ã€‚å¦‚æœå­—ç¬¦ä¸²å¤ªé•¿ï¼Œä½¿å¡«å……åçš„å­—ç¬¦ä¸²é•¿åº¦è¶…è¿‡äº†ç›®æ ‡é•¿åº¦ï¼Œåˆ™åªä¿ç•™æœ€å·¦ä¾§çš„éƒ¨åˆ†ï¼Œå…¶ä»–éƒ¨åˆ†ä¼šè¢«æˆªæ–­ã€‚æ­¤å‚æ•°çš„é»˜è®¤å€¼ä¸º `" "`ï¼ˆU+0020ï¼‰ã€‚

``str.padEnd(targetLength, padString)``

- `targetLength`ï¼šå½“å‰å­—ç¬¦ä¸²éœ€è¦å¡«å……åˆ°çš„ç›®æ ‡é•¿åº¦ã€‚å¦‚æœè¿™ä¸ªæ•°å€¼å°äºå½“å‰å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ™è¿”å›å½“å‰å­—ç¬¦ä¸²æœ¬èº«ã€‚
- `padString`ï¼šå¯é€‰çš„ã€‚å¡«å……å­—ç¬¦ä¸²ã€‚å¦‚æœå­—ç¬¦ä¸²å¤ªé•¿ï¼Œä½¿å¡«å……åçš„å­—ç¬¦ä¸²é•¿åº¦è¶…è¿‡äº†ç›®æ ‡é•¿åº¦ï¼Œåˆ™åªä¿ç•™æœ€å·¦ä¾§çš„éƒ¨åˆ†ï¼Œå…¶ä»–éƒ¨åˆ†ä¼šè¢«æˆªæ–­ã€‚æ­¤å‚æ•°çš„ç¼ºçœå€¼ä¸º `" "`ï¼ˆU+0020ï¼‰ã€‚

**ä¾‹å­**

```js
'abc'.padStart(10);         // "       abc"
'abc'.padStart(10, "foo");  // "foofoofabc"
'abc'.padStart(6,"123465"); // "123abc"
'abc'.padStart(8, "0");     // "00000abc"
'abc'.padStart(1);          // "abc"
```

```js
'abc'.padEnd(10);          // "abc       "
'abc'.padEnd(10, "foo");   // "abcfoofoof"
'abc'.padEnd(6, "123456"); // "abc123"
'abc'.padEnd(1);           // "abc"
```

## ES9

### 1 for await...of

å¾ªç¯è¿­ä»£å¼‚æ­¥å¯¹è±¡æ„æˆçš„æ•°ç»„ç­‰å¯è¿­ä»£å¯¹è±¡

**è¯­æ³•**

async function process(iterable) {  for await (variable of iterable) { // Do something. } }

- `variable`ï¼šåœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œå°†ä¸åŒå±æ€§çš„å€¼åˆ†é…ç»™å˜é‡ã€‚å˜é‡æœ‰å¯èƒ½ä»¥ constã€let æˆ–è€… var æ¥å£°æ˜ã€‚
- `iterable`ï¼šè¢«è¿­ä»£æšä¸¾å…¶å±æ€§çš„å¯¹è±¡ã€‚ä¸ for...of ç›¸æ¯”ï¼Œè¿™é‡Œçš„å¯¹è±¡å¯ä»¥è¿”å› Promiseï¼Œå¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆ variable å°†æ˜¯ Promise æ‰€åŒ…å«çš„å€¼ï¼Œå¦åˆ™æ˜¯å€¼æœ¬èº«ã€‚

**ä¾‹å­**

```js
function getTime(seconds){
  return new Promise(resolve=>{
    setTimeout(() => {
      resolve(seconds)
    }, seconds);
  })
}
async function test(){
  let arr = [getTime(500), getTime(300), getTime(3000)];
  for await (let x of arr){
    console.log(x); // 500  300 3000 æŒ‰é¡ºåºçš„
  }
}

test()
```

### 2 Promise.prototype.finally

`finally()` æ–¹æ³•è¿”å›ä¸€ä¸ª Promiseã€‚åœ¨ Promise ç»“æŸæ—¶ï¼Œæ— è®ºç»“æœæ˜¯ fulfilled è¿˜æ˜¯ rejectedï¼Œéƒ½ä¼šæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸ºåœ¨ Promise æ˜¯å¦æˆåŠŸå®Œæˆåéƒ½éœ€è¦æ‰§è¡Œçš„ä»£ç æä¾›äº†ä¸€ç§æ–¹å¼ã€‚

è¿™é¿å…äº†åŒæ ·çš„è¯­å¥éœ€è¦åœ¨ `then()` å’Œ `catch()` ä¸­å„å†™ä¸€æ¬¡çš„æƒ…å†µã€‚

**è¯­æ³•**

```js
Promise.resolve().then().catch(e => e).finally(onFinally);

onFinallyï¼šPromise ç»“æŸåè°ƒç”¨çš„ Functionã€‚
```

**ä¾‹å­**

```js
let isLoading = true;
fetch(myRequest).then(function(response) {
  const contentType = response.headers.get("content-type");
  if(contentType && contentType.includes("application/json")) {
    return response.json();
  }
  throw new TypeError("Oops, we haven't got JSON!");
})
.then(function(json) { /* process your JSON further */ })
.catch(function(error) { console.log(error); })
.finally(function() { isLoading = false; });
```

æ³¨æ„ï¼šç”±äºæ— æ³•çŸ¥é“ promise çš„æœ€ç»ˆçŠ¶æ€ï¼Œæ‰€ä»¥ finally çš„å›è°ƒå‡½æ•°ä¸­ä¸æ¥æ”¶ä»»ä½•å‚æ•°ï¼Œå®ƒä»…ç”¨äºæ— è®ºæœ€ç»ˆç»“æœå¦‚ä½•éƒ½è¦æ‰§è¡Œçš„æƒ…å†µã€‚

### 3 Object Rest/Spread Propertiesï¼ˆå¸¸ç”¨ï¼‰

å°† `Rest` è¯­æ³•æ·»åŠ åˆ°è§£æ„ä¸­ã€‚`Rest` å±æ€§æ”¶é›†é‚£äº›å°šæœªè¢«è§£æ„æ¨¡å¼æ‹¾å–çš„å‰©ä½™å¯æšä¸¾å±æ€§é”®ã€‚

å°† `Spread` è¯­æ³•æ·»åŠ åˆ°å¯¹è±¡å­—é¢é‡ä¸­ã€‚å°†å·²æœ‰å¯¹è±¡çš„æ‰€æœ‰å¯æšä¸¾ï¼ˆ `enumerable` ï¼‰å±æ€§æ‹·è´åˆ°æ–°æ„é€ çš„å¯¹è±¡ä¸­ã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**è¯­æ³•**

Rest

```javascript
const { x, y, ...z } = { x: 1, y: 2, a: 3, b: 4 };
x; // 1
y; // 2
z; // { a: 3, b: 4 }
```

Spread

```javascript
let n = { x, y, ...z };
n; // { x: 1, y: 2, a: 3, b: 4 }
```

## ES10

### 1 Array.prototype.flat å’Œ Array.prototype.flatMap

`flat()` æ–¹æ³•ä¼šæŒ‰ç…§ä¸€ä¸ªå¯æŒ‡å®šçš„æ·±åº¦é€’å½’éå†æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¸éå†åˆ°çš„å­æ•°ç»„ä¸­çš„å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªæ–°æ•°ç»„è¿”å›ã€‚

`flatMap()` æ–¹æ³•é¦–å…ˆä½¿ç”¨æ˜ å°„å‡½æ•°æ˜ å°„æ¯ä¸ªå…ƒç´ ï¼Œç„¶åå°†ç»“æœå‹ç¼©æˆä¸€ä¸ªæ–°æ•°ç»„ã€‚

`flatMap` æ–¹æ³•ä¸ `map` æ–¹æ³•ç»“åˆæ·±åº¦ `depth` ä¸º `1` çš„ `flat` å‡ ä¹ç›¸åŒã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

#### è¯­æ³•

arr.flat(depth)

- `depth`ï¼šå¯é€‰çš„ã€‚æŒ‡å®šè¦æå–åµŒå¥—æ•°ç»„çš„ç»“æ„æ·±åº¦ï¼Œé»˜è®¤å€¼ä¸º `1`ã€‚

arr.flatMap( function callback( currentValue[, index[, array]]) { // return element for new_array }[, thisArg])

- callbackï¼šå¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–°æ•°ç»„ä¸­çš„å…ƒç´ çš„å‡½æ•°ï¼Œå¯ä»¥ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š

  - `currentValue`ï¼šå½“å‰æ­£åœ¨æ•°ç»„ä¸­å¤„ç†çš„å…ƒç´ ã€‚

  - `index`ï¼šå¯é€‰çš„ã€‚æ•°ç»„ä¸­æ­£åœ¨å¤„ç†çš„å½“å‰å…ƒç´ çš„ç´¢å¼•ã€‚

  - `array`ï¼šå¯é€‰çš„ã€‚æ•°ç»„ä¸­æ­£åœ¨å¤„ç†çš„å½“å‰å…ƒç´ çš„ç´¢å¼•ã€‚

- `thisArg`ï¼šå¯é€‰çš„ã€‚æ‰§è¡Œ callback å‡½æ•°æ—¶ ä½¿ç”¨çš„ `this` å€¼ã€‚

**ä¾‹å­ï¼š**

```javascript
[1, 2, [3, 4]].flat(1); 
// [1, 2, 3, 4]

[1, 2, [3, 4, [5, 6]]].flat(2); 
// [1, 2, 3, 4, 5, 6]

[1, 2, [3, 4, [5, 6]]].flat(Infinity); 
// [1, 2, 3, 4, 5, 6]
```



**ä¾‹å­ï¼š**

```javascript
[1, 2, 3, 4].flatMap(a => [a ** 2]); 
// [1, 4, 9, 16]
map()` ä¸ `flatMap()
const arr1 = [1, 2, 3, 4];

arr1.map(x => [x * 2]);
// [[2], [4], [6], [8]]

arr1.flatMap(x => [x * 2]);
// [2, 4, 6, 8]

arr1.map(x => [x * 2]).flat(1);
// [2, 4, 6, 8]

// only one level is flattened
arr1.flatMap(x => [[x * 2]]);
// [[2], [4], [6], [8]]
let arr1 = ["it's Sunny in", "", "California"];

arr1.map(x => x.split(" "));
// [["it's","Sunny","in"],[""],["California"]]

arr1.flatMap(x => x.split(" "));
// ["it's","Sunny","in", "", "California"]
```

### 2 String.prototype.trimStart å’Œ String.prototype.trimEnd

å»é™¤å­—ç¬¦ä¸²é¦–å°¾çš„è¿ç»­ç©ºç™½ç¬¦ã€‚

`trimStart()` æ–¹æ³•ä»å­—ç¬¦ä¸²çš„å¼€å¤´åˆ é™¤ç©ºç™½ç¬¦ã€‚`trimLeft()` æ˜¯æ­¤æ–¹æ³•çš„åˆ«åã€‚

`trimEnd()` æ–¹æ³•ä»å­—ç¬¦ä¸²çš„ç»“å°¾åˆ é™¤ç©ºç™½ç¬¦ã€‚`trimRight()` æ˜¯æ­¤æ–¹æ³•çš„åˆ«åã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**ä¾‹å­**

```js
const greeting = '   Hello world!   ';
console.log(greeting.trimStart());
// "Hello world!   ";
console.log(greeting.trimEnd());
// "   Hello world!";
```

## ES11

### 1 Dynamic Import

åŠ¨æ€å¯¼å…¥æ¨¡å—

æ ‡å‡†ç”¨æ³•çš„ `import` å¯¼å…¥çš„æ¨¡å—æ˜¯é™æ€çš„ï¼Œä¼šä½¿æ‰€æœ‰è¢«å¯¼å…¥çš„æ¨¡å—ï¼Œåœ¨åŠ è½½æ—¶å°±è¢«ç¼–è¯‘ï¼ˆæ— æ³•åšåˆ°æŒ‰éœ€ç¼–è¯‘ï¼Œé™ä½é¦–é¡µåŠ è½½é€Ÿåº¦ï¼‰ã€‚æœ‰äº›åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›æ ¹æ®æ¡ä»¶å¯¼å…¥æ¨¡å—æˆ–è€…æŒ‰éœ€å¯¼å…¥æ¨¡å—ï¼Œè¿™æ—¶ä½ å¯ä»¥ä½¿ç”¨åŠ¨æ€å¯¼å…¥ä»£æ›¿é™æ€å¯¼å…¥ã€‚ä¸‹é¢çš„æ˜¯ä½ å¯èƒ½ä¼šéœ€è¦åŠ¨æ€å¯¼å…¥çš„åœºæ™¯ï¼š

- å½“é™æ€å¯¼å…¥çš„æ¨¡å—å¾ˆæ˜æ˜¾çš„é™ä½äº†ä»£ç çš„åŠ è½½é€Ÿåº¦ä¸”è¢«ä½¿ç”¨çš„å¯èƒ½æ€§å¾ˆä½ï¼Œæˆ–è€…å¹¶ä¸éœ€è¦é©¬ä¸Šä½¿ç”¨å®ƒã€‚
- å½“é™æ€å¯¼å…¥çš„æ¨¡å—å¾ˆæ˜æ˜¾çš„å ç”¨äº†å¤§é‡ç³»ç»Ÿå†…å­˜ä¸”è¢«ä½¿ç”¨çš„å¯èƒ½æ€§å¾ˆä½ã€‚
- å½“è¢«å¯¼å…¥çš„æ¨¡å—ï¼Œåœ¨åŠ è½½æ—¶å¹¶ä¸å­˜åœ¨ï¼Œéœ€è¦å¼‚æ­¥è·å–ã€‚
- å½“å¯¼å…¥æ¨¡å—çš„è¯´æ˜ç¬¦ï¼Œéœ€è¦åŠ¨æ€æ„å»ºã€‚ï¼ˆé™æ€å¯¼å…¥åªèƒ½ä½¿ç”¨é™æ€è¯´æ˜ç¬¦ï¼‰ã€‚
- å½“è¢«å¯¼å…¥çš„æ¨¡å—æœ‰å‰¯ä½œç”¨ï¼ˆè¿™é‡Œè¯´çš„å‰¯ä½œç”¨ï¼Œå¯ä»¥ç†è§£ä¸ºæ¨¡å—ä¸­ä¼šç›´æ¥è¿è¡Œçš„ä»£ç ï¼‰ï¼Œè¿™äº›å‰¯ä½œç”¨åªæœ‰åœ¨è§¦å‘äº†æŸäº›æ¡ä»¶æ‰è¢«éœ€è¦æ—¶ã€‚ï¼ˆåŸåˆ™ä¸Šæ¥è¯´ï¼Œæ¨¡å—ä¸èƒ½æœ‰å‰¯ä½œç”¨ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œä½ æ— æ³•æ§åˆ¶ä½ æ‰€ä¾èµ–çš„æ¨¡å—çš„å†…å®¹ï¼‰ã€‚

**è¯­æ³•**

``import()``

```js
import('/modules/my-module.js')  
  .then((module) => {    
  *// Do something with the module.*  
	});
// æ”¯æŒawait
const module = await import('/modules/my-module.js');

```

æ³¨æ„äº‹é¡¹ï¼š

è¯·ä¸è¦æ»¥ç”¨åŠ¨æ€å¯¼å…¥ï¼ˆåªæœ‰åœ¨å¿…è¦æƒ…å†µä¸‹é‡‡ç”¨ï¼‰ã€‚ é™æ€æ¡†æ¶èƒ½æ›´å¥½åœ°åˆå§‹åŒ–ä¾èµ–ï¼Œè€Œä¸”æ›´æœ‰åˆ©äºé™æ€åˆ†æå·¥å…·å’Œ `tree shaking` å‘æŒ¥ä½œç”¨ã€‚

ä¸é™æ€ `import` å·®å¼‚ï¼š

- `import()` å¯ä»¥ä»è„šæœ¬ä¸­ä½¿ç”¨ï¼Œè€Œä¸ä»…ä»…æ˜¯ä»æ¨¡å—ä¸­ä½¿ç”¨ã€‚
- å¦‚æœ `import()` åœ¨æ¨¡å—ä¸­ä½¿ç”¨ï¼Œå®ƒå¯ä»¥å‡ºç°åœ¨ä»»ä½•çº§åˆ«çš„ä»»ä½•åœ°æ–¹ï¼Œå¹¶ä¸”ä¸ä¼šè¢«æå‡ã€‚
- `import()` æ¥å—ä»»æ„å­—ç¬¦ä¸²ï¼ˆæ­¤å¤„æ˜¾ç¤ºäº†è¿è¡Œæ—¶ç¡®å®šçš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼‰ï¼Œè€Œä¸ä»…ä»…æ˜¯é™æ€å­—ç¬¦ä¸²æ–‡å­—ã€‚
- æ¨¡å—ä¸­å­˜åœ¨ `import()` å¹¶ä¸ä¼šå»ºç«‹ä¾èµ–å…³ç³»ï¼Œåœ¨å¯¹åŒ…å«çš„æ¨¡å—æ±‚å€¼ä¹‹å‰ï¼Œå¿…é¡»å…ˆè·å–å¹¶æ±‚å€¼ä¾èµ–å…³ç³»ã€‚
- `import()` ä¸å»ºç«‹å¯ä»¥é™æ€åˆ†æçš„ä¾èµ–å…³ç³»ï¼ˆä½†æ˜¯ï¼Œåœ¨è¯¸å¦‚ `import('./foo.js')` è¿™æ ·çš„ç®€å•æƒ…å†µä¸‹ï¼Œå®ç°å¯èƒ½ä»ç„¶èƒ½å¤Ÿæ‰§è¡Œæ¨æµ‹æ€§æŠ“å–ï¼‰ã€‚

### 2 Promise.allSettled

`Promise.allSettled()` æ–¹æ³•è¿”å›ä¸€ä¸ªåœ¨æ‰€æœ‰ç»™å®šçš„ `promise` éƒ½å·²ç» `fulfilled` æˆ– `rejected` åçš„ `promise`ï¼Œå¹¶å¸¦æœ‰ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡è¡¨ç¤ºå¯¹åº”çš„ `promise` ç»“æœã€‚

å½“æ‚¨æœ‰å¤šä¸ªå½¼æ­¤ä¸ä¾èµ–çš„å¼‚æ­¥ä»»åŠ¡æˆåŠŸå®Œæˆæ—¶ï¼Œæˆ–è€…æ‚¨æ€»æ˜¯æƒ³çŸ¥é“æ¯ä¸ª `promise` çš„ç»“æœæ—¶ï¼Œé€šå¸¸ä½¿ç”¨å®ƒã€‚

ç›¸æ¯”ä¹‹ä¸‹ï¼Œ`Promise.all()` æ›´é€‚åˆå½¼æ­¤ç›¸äº’ä¾èµ–æˆ–è€…åœ¨å…¶ä¸­ä»»ä½•ä¸€ä¸ª `reject` æ—¶ç«‹å³ç»“æŸã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

| api                | æè¿°                          |                    |
| ------------------ | ----------------------------- | ------------------ |
| Promise.allSettled | ä¸ä¼šçŸ­è·¯                      | æœ¬ææ¡ˆ ğŸ†•           |
| Promise.all        | å½“å­˜åœ¨è¾“å…¥å€¼ rejected æ—¶çŸ­è·¯  | åœ¨ ES2015 ä¸­æ·»åŠ  âœ… |
| Promise.race       | å½“å­˜åœ¨è¾“å…¥å€¼ ç¨³å®š æ—¶çŸ­è·¯      | åœ¨ ES2015 ä¸­æ·»åŠ  âœ… |
| Promise.any        | å½“å­˜åœ¨è¾“å…¥å€¼ fulfilled æ—¶çŸ­è·¯ | åœ¨ ES2021 ä¸­æ·»åŠ  âœ… |

### 3 Optional Chainingï¼ˆå¸¸ç”¨ï¼‰

å¯é€‰é“¾æ“ä½œç¬¦ï¼ˆ`?.`ï¼‰å…è®¸è¯»å–ä½äºè¿æ¥å¯¹è±¡é“¾æ·±å¤„çš„å±æ€§çš„å€¼ï¼Œè€Œä¸å¿…æ˜ç¡®éªŒè¯é“¾ä¸­çš„æ¯ä¸ªå¼•ç”¨æ˜¯å¦æœ‰æ•ˆã€‚`?.` æ“ä½œç¬¦çš„åŠŸèƒ½ç±»ä¼¼äº `.` é“¾å¼æ“ä½œç¬¦ï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼Œåœ¨å¼•ç”¨ï¼ˆ`null` æˆ–è€… `undefined`ï¼‰çš„æƒ…å†µä¸‹ä¸ä¼šå¼•èµ·é”™è¯¯ï¼Œè¯¥è¡¨è¾¾å¼çŸ­è·¯è¿”å›å€¼æ˜¯ `undefined`ã€‚ä¸å‡½æ•°è°ƒç”¨ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¦‚æœç»™å®šçš„å‡½æ•°ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› `undefined`ã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**è¯­æ³•

```
obj?.prop
obj?.[expr]
arr?.[index]
func?.(args)
```

**ä¾‹å­**

```js
letÂ userÂ =Â {};
letÂ u1Â =Â user.childer.name;
//Â TypeError:Â CannotÂ readÂ propertyÂ 'name'Â ofÂ undefined
letÂ u1Â =Â user?.childer?.name;
//Â undefined
```

## ES12

### 1 String.prototype.replaceAll

`replaceAll()` æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œæ–°å­—ç¬¦ä¸²æ‰€æœ‰æ»¡è¶³ `pattern` çš„éƒ¨åˆ†éƒ½å·²è¢« `replacement` æ›¿æ¢ã€‚`pattern` å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ª `RegExp`ï¼Œ `replacement` å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ªåœ¨æ¯æ¬¡åŒ¹é…è¢«è°ƒç”¨çš„å‡½æ•°ã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**è¯­æ³•**

``String.prototype.replaceAll(searchValue, replaceValue);``

**ç”¨æ³•**

```js
const queryString = 'q=query+string+parameters'; 
const withSpaces = queryString.replaceAll('+', ' ');
```

### 2 Promise.any

`Promise.any()` æ¥æ”¶ä¸€ä¸ª `Promise` å¯è¿­ä»£å¯¹è±¡ï¼Œåªè¦å…¶ä¸­çš„ä¸€ä¸ª `promise` æˆåŠŸï¼Œå°±è¿”å›é‚£ä¸ªå·²ç»æˆåŠŸçš„ `promise`ã€‚å¦‚æœå¯è¿­ä»£å¯¹è±¡ä¸­æ²¡æœ‰ä¸€ä¸ª `promise` æˆåŠŸï¼ˆå³æ‰€æœ‰çš„ `promises` éƒ½å¤±è´¥/æ‹’ç»ï¼‰ï¼Œå°±è¿”å›ä¸€ä¸ªå¤±è´¥çš„ `promise`ã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**ä¾‹å­**

```
constÂ promise1Â =Â newÂ Promise((resolve,Â reject)Â =>Â reject('å¤±è´¥çš„Promise1'));
constÂ promise2Â =Â newÂ Promise((resolve,Â reject)Â =>Â reject('å¤±è´¥çš„Promise2'));
constÂ promiseListÂ =Â [promise1,Â promise2];
Promise.any(promiseList)
.then(values=>{
Â Â console.log(values);
})
.catch(error=>{
Â Â console.log(error);
});
```

### 3 Numeric Separators

æ•°å­—åˆ†éš”ç¬¦

å®ƒæ˜¯å°†å…¶æ—©æœŸè‰æ¡ˆä¸ `Christophe Porteneuve` çš„ææ¡ˆ `numeric underscores` åˆå¹¶çš„ç»“æœï¼Œä»¥æ‰©å±•ç°æœ‰çš„ `NumericLiteral` ä»¥å…è®¸æ•°å­—ä¹‹é—´çš„åˆ†éš”ç¬¦ã€‚

> è¯¥ææ¡ˆç›®å‰å¤„äº Stage 4 é˜¶æ®µã€‚

**ç”¨æ³•**

ä½¿ç”¨ä¸‹åˆ’çº¿ `_`ï¼ˆU+005Fï¼‰åœ¨æ•°å­—é—´è¿›è¡Œåˆ†éš”ã€‚

**è¯­æ³•**

```js
constÂ price1Â =Â 1_000_000_000;
constÂ price2Â =Â 1000000000;
price1 === price2;Â //Â true

const float1 = 0.000_001;
const float2 = 0.000001;
float1 === float2; // true;
```

